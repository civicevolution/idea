%div.idea_details
	= stylesheet_link_tag "ce/idea_details"

	- if idea.is_theme
		%h3 Theme
	- elsif idea.parent_id.nil?
		%h3 New idea of #{idea.siblings_count}
	- else
		%h3 Idea #{idea.order_id} of #{idea.siblings_count}

	%div.details_left
		
		%ul
			- if idea.is_theme
				%li.theme_post_it
					%a{href: '#', class: "R#{idea.id.to_s.match(/\d$/)[0]}"}
						%p.idea= idea.text
				%p.timestamp
					#{time_ago_in_words(idea.updated_at)} ago,
					Version #{idea.version}
					-# if idea.version > 1
						= link_to "View history", {}
			- else
				%li.idea_post_it
					%a{href: '#', class: "R#{idea.id.to_s.match(/\d$/)[0]}"}
						%p.idea= idea.text
						= image_tag 'delete_icon_16t.gif', :class=>"delete"
				%p.timestamp
					#{time_ago_in_words(idea.updated_at)} ago
					
		%div.rater.corner
			- if my_rating.nil?
				%p.label.please-rate Please rate this #{idea.is_theme ? 'theme' : 'idea' }
			-else
				%p.label Your rating on this #{idea.is_theme ? 'theme' : 'idea' }
			%div.rater_faces
				= image_tag('rater/yuck.gif', class: 'yuck')		
				= image_tag('rater/meh.gif', class: 'meh')		
				= image_tag('rater/good.gif', class: 'good')		
				= image_tag('rater/great.gif', class: 'great')		
			
			%div.theme_slider{id: idea.id}		
		
			%p.results
				- votes = idea.idea_ratings.size
				%span.vote_count
					= pluralize(votes,'vote')
				- if votes > 1
					= link_to "View results", {}

		= form_tag add_idea_comment_path(idea.id), :class=>'std_form add_comment', :remote=>true do 
			%div.add_idea
				= text_area_tag :text, '', class: 'answer autosize empty', size: "1x2", fixed_rows: true, placeholder: 'Write your comment...'
			
			%p.form_controls
				= submit_tag "Add comment", :name=>'endorse', 'data-disable-with'=>'Submitting...'
				%span.char_ctr 1500 characters
				= link_to 'Clear', '#', {:class=>'clear', :rel=>'nofollow'}

			%p.clear
			
		= submit_tag "Follow this discussion", :name=>'endorse', 'data-disable-with'=>'Submitting...'
		
		%div.activity_stream
			- idea.comments.each do |comment|
				= render( :partial=> 'ideas/comment', :locals=>{:comment=>comment}, formats: [:html]  )
		
		
	%div.details_right
		%div.right_buttons
			= button_tag "Edit"
			= button_tag "Browse ideas"
			= button_tag "Theme page"
			= button_tag "Format answer"
			= button_tag "Add comment"
			= button_tag "Follow"
			= button_tag "Browse attachments"

