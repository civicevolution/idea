= render :template => 'shared/clear_sign_in_form.js'
:plain
	var tp_coms = $("#{escape_javascript(
		render( :partial=> 'comments/talking_point_comments.html', :locals=> {:talking_point => talking_point, :comments => comments, :com_criteria => com_criteria } )
	)}");
	var tp = $('div.talking_point_entry[id="#{talking_point.id}"]')
	$('div.talking_point_comments.discussion[id="#{talking_point.id}"]').remove();
	var newNode = $(tp_coms).insertAfter(tp);
	newNode.find('abbr').timeago();
	activate_text_counters_grow( newNode.find('textarea'), 30 );
	$('div.talking_point_comments.discussion[id="#{talking_point.id}"]').find('a.clear').html('Clear').die('click').live('click',
		function(){
			$(this).closest('form').find('textarea').val('');
			$(this).closest('form').find('div#errorExplanation').remove();
			return false;
		}
	);
	setTimeout( function(){	$('.corner').corner()},100);
	
	if(tp_coms.height()>400){
		tp_coms.append(tp_coms.find('a.tp_hide_coms').clone());
	}
	
	$('a.tp_hide_coms').die('click').live('click',
		function(){
			// update the number of comments
			var disc = $(this).closest('div.talking_point_comments');
			if(disc.size() > 0){
				var p = disc.prev('div.talking_point_entry').find('div.talking_point_com_count p');
		  	var com_cnt = disc.find('div.Comment').size();
		  	switch(com_cnt){
		  		case 0:
		  			p.html('+');
						p.attr('title','Click to add a comment');
		  			break;
		  		case 1:
		  			p.html('1');
						p.attr('title','Click to see 1 comment');
		  			break;
		  		default:
		  			p.html(com_cnt);
						p.attr('title','Click to see ' + com_cnt + ' comments');
		  			break;
		  	}
		  	disc.remove();
		  }
			return false;
		}
	);
